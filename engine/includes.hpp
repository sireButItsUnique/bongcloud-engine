#pragma once
#include <algorithm>
#include <chrono>
#include <intrin.h>
#include <iomanip>
#include <iostream>
#include <locale.h>
#include <random>
#include <sstream>
#include <stdint.h>
#include <stdio.h>
#include <string>
#include <time.h>
#include <unordered_map>
#include <utility>
#include <vector>
using namespace std;

#define pawnWhite 0
#define pawnBlack 1
#define knightWhite 2
#define knightBlack 3
#define bishopWhite 4
#define bishopBlack 5
#define rookWhite 6
#define rookBlack 7
#define queenWhite 8
#define queenBlack 9
#define kingWhite 10
#define kingBlack 11
#define NORTH 0
#define NORTHEAST 1
#define EAST 2
#define SOUTHEAST 3
#define SOUTH 4
#define SOUTHWEST 5
#define WEST 6
#define NORTHWEST 7
#define ll long long
#define white false
#define black true
#define DOUBLE_INF 1000000000

#define TO_SQUARE(col, row) 8 * (row - '1') + 7 - (col - 'a')
#define TO_ALGEBRA(sq) string(1, 'a' + (7 - (sq % 8))) + string(1, '1' + (sq / 8))
#define BOLD "\e[1m"
#define UNBOLD "\e[0m"
#define GREEN "\x1B[32m"
#define UNCOLOR "\x1B[0m"

/**
 * @brief zPiece[piece][square] = baseZ
 *
 */
const unsigned ll zPiece[12][64] = {
	{9052354433314688160, 3512702351434464653, 8950685873730499441, 7802743579122014046, 3300479587422561680, 9196327278092669110, 3639508160691122470,
	 4507133936494692003, 5233578138178256397, 7351589143768437691, 9162335013007182473, 292116028467144497,  7232186173012443722, 2074379542274060364,
	 5966755491002943653, 4819379022588983063, 6572351137397916891, 2776052346984939800, 8895203781237843598, 5589242174518702143, 8272197851847030750,
	 5691699977876399034, 4985314703316629689, 3430314362598774471, 5527688666934504835, 3301841762496181845, 2456112795228908208, 8982282615162349100,
	 4764613429530252058, 9120166772984801500, 2214988555401754768, 5020864048261542113, 1457695102066176541, 782268120585898349,  2207538786703187620,
	 4104442328146808555, 731659498446263818,  8469193000057895064, 3623442162814537512, 3964434799089276639, 1823107680635578966, 2455871760759071934,
	 8392300504609568459, 6193489205288289107, 7929206957472760967, 2478049075368564091, 4831623650036173246, 3280471222088807085, 3026407642826659951,
	 6864913231052881007, 4655546866333123152, 6239612699936016370, 1220732898288243944, 351437176911176017,  7555341653303938355, 7489740813669717331,
	 6220135631313811685, 6213432957584206302, 611997998158827760,	5595464979936909488, 3340272892388383770, 3366396915104873733, 1410169350679833936,
	 2130129060299008770},
	{2352696184463803903, 1378141642651098498, 6981126667542330017, 3723468271397612601, 7710223863251444808, 423136906196533331,  6063448069793088344,
	 8812107991248793031, 1810221435248955582, 8596026667294425059, 909882449086967015,	 2042637968291418862, 7184436555904749447, 3360966937602179631,
	 301240786183191945,  3662519165318603706, 5002347024147877843, 2044366628824216895, 5960182146953123589, 5404662881513356027, 5115708048509932408,
	 6711691935534618633, 8202771706872003104, 6398590800816986868, 7018629790593782409, 7589457575275580410, 2048088260989307312, 1039948387415358846,
	 2616206796773375951, 2452325983201512591, 6396747460378140142, 8907724863105940948, 2866603271049898123, 6146672058139944050, 8391793250843171022,
	 3813229845618482381, 7894052541893322353, 1135883774524111621, 4477720045045737219, 7055518906464674226, 8636448978361816060, 8935955208810997768,
	 4691269040144216690, 2546295689001543727, 3853527969823669671, 3408396247885614457, 9091671756468546038, 9160205882460081827, 9168455721978733221,
	 412975418251257703,  1959079114197190606, 6723481060092015120, 7705877181647411487, 4339920452570868128, 8690481823783220126, 5192021758627346756,
	 8735152304905177204, 9067901641526304787, 5259488278823788668, 8108358436930453786, 3286038911548573562, 8240523367556238764, 2144401486292485085,
	 1580394702925829829},
	{7610132733244179824, 9002207735514214709, 2837707323327537421, 3338583187675395081, 474230098500476875,  7368197434490958126, 4372240107500203300,
	 123908783507799878,  5514710262392431366, 6480778543896164540, 8703413218007848173, 4811765899911930828, 2066060748438931620, 931275708315323,
	 8337766882469938924, 2814995990311871169, 7001129116194147058, 105758300983237785,	 4467194060529289921, 8434097204924326947, 6539310474646288064,
	 6587547245724636559, 6585604561279072570, 3975221136124714846, 2463018796214604834, 1879500124097561501, 3828505042740822523, 7329865995632099164,
	 3216306276933912269, 1829903307170217520, 2851302062339203443, 3365777286733645104, 1464679048857994204, 7658303167773055913, 8117304561527649996,
	 2051934221442517708, 2095417453589083050, 870191788770374161,	8107066744022270043, 379629989293978460,  4648966137436541582, 7828196417869884437,
	 5775185676554022521, 4977403124828954179, 6871216055283030639, 5276380005542160532, 4491373006644090778, 6947313024662256146, 6851135497295775521,
	 7406155867896402629, 4565599453233370108, 8457104526064962244, 2935826594872902941, 323709243979682146,  6999238077851580689, 2534047824575257048,
	 1538942410446000969, 2543390882054155820, 8259886941387800354, 7312864494704045919, 7650263096161567364, 7153754906821125060, 1716075179995578115,
	 499190273606551705},
	{1649309640265452936, 4722406936638987110, 8089242874188323033, 8734416163186731626, 6633333385902483851, 3187020475847470661, 95660920418943342,
	 8790706589075804877, 2581291459519681960, 4580047768306062863, 2764737923673639753, 7377840404391742087, 2623688894264994754, 8096542011943309530,
	 4921161466767815242, 4433063326756602395, 9165806566652420703, 8093371768549311312, 153398086456748150,  136834685457506909,  1357866286857536763,
	 8808293712056741708, 3848160922773973583, 7503730662765031689, 3727589463850886099, 8544311872783367767, 4432930047411307189, 4909100912890403786,
	 8819179751601550513, 5117992644733478694, 2120739002868556483, 8140618985596733451, 4031626680353540410, 7519613629348620141, 493573041766752884,
	 1307903455019776738, 8917673417213305835, 8347830747056170221, 8511737503422792691, 9121121241960879694, 1418198063592663073, 1572363350480084074,
	 6076349668418751131, 2907393945847101572, 6863897986104512771, 3940587635383952071, 2002968675533172765, 6659587895045913806, 3784762249860113381,
	 5728136573313457640, 5925266337771413704, 8140339724896125086, 521112961482298818,	 8062944052025083290, 6371572976062536788, 8747937622940831318,
	 8470849896720497419, 5314225486742012276, 911137592947119463,	3776791954145699955, 7005441936897762244, 5896123061435582689, 8515455121819861475,
	 5253143905246417462},
	{2705258908051974323, 4061698287928705517, 6548449186233428769, 3005170479417412164, 4952301096955635183, 5305079199593952692, 7916864859987549174,
	 4238569914023575060, 4235254904061098753, 7630141808789383253, 5910337647644928514, 3910694656339728391, 3505937768808618447, 2093370258757704053,
	 4701848242987010851, 8761125050209436389, 4201473384749825249, 5058821137935859888, 963976587977212806,  4733062022984750785, 3546601687692395749,
	 8683705531839716991, 1696634511800125043, 4745428608394232551, 6909296386683884630, 2420559624153660430, 325068220666324681,  7780335927327436050,
	 2622666202295138628, 5534471638499477905, 7436543312996231002, 8545515592204836675, 5617011076802168215, 3678698365510894726, 7196869543010774253,
	 4374548448369176454, 4777261080424206420, 8755601551576068372, 4509055061494836316, 3634647411228566877, 6924838959138234836, 3061949827523156677,
	 2795123367196425530, 1144079385080365110, 9098725845449749976, 2525092874371410820, 6072147666806987587, 4563342736547870167, 2798771835288140946,
	 1379423602684542325, 985954318525538944,  2993966439211569896, 6910756875662738503, 4879739169250717351, 797876486513559813,  7362965518642576401,
	 4893242088902825956, 7446391760655184040, 1665007597350931442, 3219051357844252231, 5137571375714135497, 3774270273633553174, 3693726977688913094,
	 7540095905050426332},
	{3992130782637066019, 5198511013758659413, 7079201488212737141, 24902201298761967,	 8130787217614489926, 3995871420929230298, 1765114811463163703,
	 3948467170740374265, 1172525088666478368, 2133457281040176201, 3714960758508905134, 120123832564441862,  6905753956851426069, 3481828366471897082,
	 6243261538181335425, 3923950080391687170, 4663107909591090475, 5143606829431431609, 5892724790225704408, 6685999649406940040, 121703205534234331,
	 1293288580196650607, 269733455554305211,  2665109540517026027, 4025072386983831337, 4540872616419398461, 5084438902308696398, 8031175226401478853,
	 7813054073768871456, 6886386090184931224, 2780654818436648512, 6153150787698427464, 7257064693664993127, 7075352808894815937, 8231002379924961574,
	 1177834505844187697, 644139053911594589,  4971580133257934896, 1317004741580085457, 5895822707566728047, 6557549674934310066, 5781088588790783606,
	 7450734931770426718, 6066049584370833325, 8845242378003651986, 8386404519507336166, 3114059944914214247, 300282535794072437,  8887836519467752870,
	 2803743821571454987, 747589426447775806,  3133793556750023536, 4302910502959965935, 6137418719285152299, 5894536489165097620, 4916358113147804669,
	 5335737489499974497, 329504608394300587,  5689573049789176495, 1216981529268473517, 6482505048074446928, 3667363890098302712, 1837899027074164425,
	 459160038979364792},
	{1634080916486953444, 2582773128031997353, 1848840820095644330, 4338945231334861229, 8597171444632364251, 8336464273569471229, 6031621302777493271,
	 5338966243262091616, 2483706933204367116, 8982807944989980884, 1659182832223610055, 1532916052678268586, 8912075487651091383, 6677484907245158360,
	 6998263052234096505, 1715274312993465656, 3792221093056636422, 1410817883958916093, 7062673039245613402, 2273529289262406243, 5660839498373320576,
	 1640064107939391938, 5812303343961087884, 7485656692594445953, 2902306682922194872, 1517232973920696042, 1580348519391228117, 917289979554083313,
	 2972572593598336107, 6873040596228844249, 7027650594418648184, 8254443284850654046, 164466350886607826,  8242536617146033776, 7415828361279174099,
	 5570847682097559889, 6838627664743882170, 8272762317265992205, 823660732943763391,	 4690915999960489793, 6152963175198071198, 6513429405007557392,
	 3497115444492645942, 7278012971004637637, 8644937974018516950, 7921886176361882287, 8658775789861397106, 1975610794596609044, 7498615463349495826,
	 4046513011829533502, 212758205998179431,  6827892610718635890, 3711313676217499929, 7374730728691113633, 970143162833529619,  2687881334371405449,
	 2356784242524148969, 3120644793973306758, 4976812205466718704, 6976771412382147365, 265818722463427050,  4113280685098878475, 6130056399489641501,
	 1314066765974080760},
	{7621520770474219396, 6529785626858110849, 8985244340589558834, 4081107763905817505, 64428539569975276,	  1395429935770476157, 7013635538877286821,
	 8302921574883947252, 4174405162502076477, 278905877239285305,	3703748403026501315, 1805356084100594367, 6028036867932860208, 7398724260861938741,
	 3367328634530204900, 7129717636370255248, 2831122384782626373, 2610531357938049615, 1271737327430763654, 2655901405295861337, 6253805065243047359,
	 8619606228730891032, 4806920867818944596, 460124396860827581,	7864033620072471534, 2029448417597946780, 7398294155800253596, 6019924482961024989,
	 54639642624633033,	  7778493498124052619, 3490389481868122395, 8158513283544581468, 276186832988972584,  2674164131386287526, 854816582122714948,
	 2429905424118024937, 6093641164485128442, 8969152696058219688, 2022819238061226321, 4035083827128125499, 1412961188952736432, 2279979660062682715,
	 7414271359263698909, 6727925169370448718, 3306139025263725601, 5175772547733605099, 2335405315676062743, 5820965293436889168, 5277632454082244357,
	 5864220493147361305, 4223841875333584509, 1000104185545477176, 3156385400884767222, 6045776521487375907, 4956681492453841514, 2669212089398378653,
	 7202831729587977469, 5730613377826535902, 4581660429939461522, 2188907769134565350, 2682378965649325444, 2722072625406978304, 2310883993655771000,
	 5517429497996464989},
	{556263176523362259,  7988506544458854141, 2489632707458371288, 3969395583420008388, 3954187868589828688, 7430805127890593885, 2138452974361830653,
	 1263812125288275117, 7889761011895367585, 2981524887258945536, 3518880461621670936, 904642058361364826,  1077319877554553222, 1519084388385223241,
	 7185079710905610719, 2372647481577646303, 2387021179504557699, 6180598374018584399, 5547338363909572464, 4339026070597453904, 7878061335461605334,
	 9068250105871739292, 7196978034081921484, 643041884738514128,	6617921349712210892, 1790470754970194098, 2069414879483623546, 3051942372761495876,
	 6010920149905244314, 484596255364370316,  3782569735330913856, 8910783336444695766, 7460295084969927531, 2822091828189806746, 8049979805238509431,
	 6734483966226498075, 6276303971113019696, 9201418625162232970, 370306295124307301,	 8225178085452184836, 1289772388018391643, 2017380529166800097,
	 2991092443340457233, 5523189166833517575, 2498141772512603386, 1092543705503878453, 1994657972510198404, 3129156416871461657, 3027512194074167964,
	 4206339484003561043, 4097793565895762328, 3578248230725094771, 1224866779347946346, 2235523886926561964, 297702904649724387,  4994128280344787629,
	 6605753650122256262, 7247537675582224471, 1309915537414092855, 506623972986124344,	 6331781538432213251, 9107562457003553916, 4113323800148222349,
	 3983980104972260790},
	{1233383199221223143, 5052809913113369968, 5566891854080052831, 1182899313299437581, 7036166256709384118, 3555223645853984512, 752675041392002525,
	 62728225213676868,	  1382749326025071895, 4635862992509412317, 728285656178632062,	 6851801391940050992, 158350052524538004,  7393409678786732236,
	 6362114532532867131, 5234301604303483550, 5944617389247672018, 1680639518079556566, 7681860223450691834, 9032210484443081028, 8320278989469297619,
	 4138969643135090538, 6177396985202442221, 6307472200921619394, 3000674540362093045, 7162629883315728867, 380619076683854914,  9096075339096865201,
	 4687454189962017976, 5491787625402001598, 8781702061120521587, 523122455190025574,	 2899617435822699493, 6420754757667911235, 5559781523413291470,
	 7662895303926972291, 212518660234962579,  270543299757111834,	2172148378160888687, 75095945085632904,	  5631478897905104866, 8157367604810771396,
	 2222330677028403092, 1999111223208111218, 4402447638740320725, 484672386066082740,	 7251376124036605822, 8742216631432000546, 1240620626117017553,
	 7049047044603819118, 981914134298392759,  3472422890674908692, 89256529918402625,	 1123160092211176631, 5399743354733213695, 4171805740706007097,
	 5025366141115009984, 5133440379563209290, 3157790682808346933, 2906075746259019187, 8892569145344749435, 9104373017591413813, 3851427999915210322,
	 3564270312496913574},
	{380517868535383609,  2634104176044240375, 510588553346461014,	3484696709875720705, 7478999510493409353, 945526934153980059,  3546115864593705132,
	 617654645913515513,  4238880988584428677, 2751721091175106067, 8129843147629365718, 2566320990153076843, 7641576657879096067, 3940962232684783322,
	 5143739076565398385, 2997719679567786232, 8121449334126591518, 2758692995859670458, 3869970708184000731, 622997741284622955,  5834660574195847938,
	 3128942626548641092, 6304972383728949538, 5374454853073955875, 7022597905935959981, 7278571306431939494, 7735853410812221445, 3721881989331140097,
	 6935198085527765833, 8466133252624600665, 2194646493774422154, 123010466788738004,	 1524142344161953592, 5205603706428720359, 4766760188082687304,
	 1327529883179914332, 3636576734653686439, 3252568810541894694, 4890646466531429603, 5247827447591216382, 444106674278644902,  3469911318965688712,
	 8879614614568508835, 2521892052008235697, 809110784601621200,	8600707526048746927, 5455728266664841509, 6695867506503095563, 6584972102692066605,
	 6216865250840604722, 3233215795785696106, 3152149309628744175, 895426493995382635,	 5439979788319989428, 7179599703542419217, 3555800948763852376,
	 2354714354880860476, 3089015993662741697, 1522982676018061545, 7537423937605152606, 3990336149398627099, 3077804410593576954, 1104456732351080603,
	 3093965412290995630},
	{1750165452836776755, 3657172399088344341, 8541507535233721756, 3658159011531885498, 4458089913254810473, 7972322438076890602, 3521252101440615014,
	 3220943267224087145, 1941704965917558949, 8414304181569903720, 1033068265245456640, 1456829094875675219, 434752734064119213,  1971200343258007004,
	 2879999826365265946, 4650131910353911157, 2687590767009901789, 2700316917008378970, 8914463931286416435, 5515649395158502725, 6671360860702630954,
	 4628510548596804135, 8409204992201524337, 6926978012897870664, 7017004725256735326, 112833383569170040,  3667994837054602059, 2088423766079639473,
	 2579775735771781270, 7888321181483242738, 7958566084102331541, 2264611237839385395, 6514893345284473368, 4981762471243519941, 229584093356379434,
	 6432810939719118544, 433870090310505027,  712981229932360894,	154166380143225290,	 5047535380606280965, 4112196847335295816, 5610540298830226965,
	 6011720292831198649, 6677177547014739619, 3414280140137533659, 5382126258662381871, 3470751557241037170, 6745134727776180586, 3157882675058508890,
	 313949688945056689,  6318308333043967277, 7053909478109743619, 8063398639464293141, 7033894658075096119, 3055790255139559894, 2993422376802100491,
	 4955331052616790274, 6776324957160064720, 669850242458971437,	6781754817302231167, 234779347046704614,  6588745037106396254, 8503585058016820818,
	 1544554757465474783},
};
/**
 * @brief zTurn = black's turn?
 *
 */
const unsigned ll zTurn = 210208592681017173;
/**
 * @brief zCastle[0] = whiteKing; zCastle[1] = whiteQueen; zCastle[2] = blackKing; zCastle[3] = blackQueen
 *
 */
const unsigned ll zCastle[4] = {3459553569836042198, 8581846297301074414, 1243373870712503197, 3134773618346841749};